# MC production scripts
The scripts in this directory control MC generation of signal (from Madgraph+Pythia through to AOD). The eras, global tags, process modifiers, etc. are put together based on a combination of reading McM configs from UL campaigns, [this page](https://exo-mc-and-i.gitbook.io/exo-mc-and-interpretation/how-to-sample-production-private) from MC&I, and [this repo](https://gitlab.cern.ch/cms-exo-mci/EXO-MCsampleProductions) from MC&I that generates `cmsDriver` configs for UL campaigns. Currently, only the 2018 MC production is implemented.

# Usage
The main driver script is `submitCondor.py`, which will submit condor jobs to do the full production pipeline for a given $(m_\chi, \Delta m_\chi, c\tau)$ combination. You will need to supply a local path to an iDM gridpack, which you can store in the `gridpacks` folder. All iDM gridpacks that we currently have can be found on eos at `/store/group/lpcmetx/iDMe/gridpacks/`. Currently there are only gridpacks for the 1 jet case (`p p > j chi1 chi2`). Usage is as follows:

``python submitCondor.py path_to_gridpack lifetime year nEvents nThreads [nev_per_job]``

`lifetime` should be specified in mm (e.g. 1, 10, 100, or 1000), `year` should be 2016/17/18 (only 2018 works currently). `nEvents` dictates how many events to generate, and `nThreads` specifies the number of CPUs to request per job and enables Pythia/CMSSW multithreading. `nev_per_job` is an optional argument that dictates how many events to generate in each job (defaults to 1000). If you ask for `nEvents = 10000` and set `nev_per_job = 1000`, it will submit 10 jobs. For large productions I have been using `nev_per_job = 10000`. In this case, roughly 3300 events will make it through the Pythia filters and each job will take about 15 hours to run.

**IMPORTANT NOTE: Make sure you have write access to the `lpcmetx` area before you run any MC generation jobs! Otherwise your jobs will run and the file transfer at the end will fail and the data will be lost!**